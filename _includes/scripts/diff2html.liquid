{% if page.code_diff %}
  <!-- diff2html doesn't go well with Bootstrap Table -->
  <script
<<<<<<< HEAD
    defer
    src="https://cdn.jsdelivr.net/npm/diff2html@{{ site.diff2html.version }}/bundles/js/diff2html-ui.min.js"
    integrity="{{ site.diff2html.integrity.js }}"
    crossorigin="anonymous"
  ></script>
  <script>
    let theme = determineComputedTheme();

    /* Create echarts chart as another node and hide the code block, appending the echarts node after it
       this is done to enable retrieving the code again when changing theme between light/dark */
    document.onreadystatechange = () => {
=======
    src="{{ site.third_party_libraries.diff2html.url.js }}"
    integrity="{{ site.third_party_libraries.diff2html.integrity.js }}"
    crossorigin="anonymous"
  ></script>
  <script>
    let diff2HtmlTheme = determineComputedTheme();

    /* Create diff2html as another node and hide the code block, appending the diff2html node after it
       this is done to enable retrieving the code again when changing theme between light/dark */
    document.addEventListener('readystatechange', () => {
>>>>>>> 0af4aecf50426fc1e35696ca4c47940737175b26
      if (document.readyState === 'complete') {
        document.querySelectorAll('pre>code.language-diff2html').forEach((elem) => {
          const textData = elem.textContent;
          const backup = elem.parentElement;
          backup.classList.add('unloaded');
          /* create diff node */
          let diffElement = document.createElement('div');
          diffElement.classList.add('diff2html');
          backup.after(diffElement);
<<<<<<< HEAD
          const configuration = { colorScheme: theme, drawFileList: true, highlight: true, matching: 'lines' };
=======
          const configuration = { colorScheme: diff2HtmlTheme, drawFileList: true, highlight: true, matching: 'lines' };
>>>>>>> 0af4aecf50426fc1e35696ca4c47940737175b26
          const diff2htmlUi = new Diff2HtmlUI(diffElement, textData, configuration);
          diff2htmlUi.draw();
        });
      }
<<<<<<< HEAD
    };
=======
    });
>>>>>>> 0af4aecf50426fc1e35696ca4c47940737175b26
  </script>
{% endif %}
